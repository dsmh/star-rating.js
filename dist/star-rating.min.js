/**
 * Star Rating
 * @version: 2.0.0
 * @author: Paul Ryley (http://geminilabs.io)
 * @url: https://github.com/geminilabs/star-rating.js
 * @license: MIT
 */
!function(e,s,i){"use strict";var t=function(t,e){this.selects="[object String]"==={}.toString.call(t)?s.querySelectorAll(t):[t],this.destroy=function(){},this.rebuild=function(){},this.widgets=[];for(var i=0;i<this.selects.length;i++)"SELECT"===this.selects[i].tagName&&this.widgets.push(new n(this.selects[i],e))},n=function(t,e){this.el=t,this.options=this.extend({},this.defaults,e||{},JSON.parse(t.getAttribute("data-options"))),this.init()};n.prototype={defaults:{clearable:!0,initialText:"Select a Rating",maxStars:10,onClick:null,showText:!0},init:function(){this.setStarCount(),this.stars<1||this.stars>this.options.maxStars||(this.current=this.selected=this.getSelectedValue(),this.wrapEl(),this.buildWidgetEl(),this.setDirection(),this.handleEvents(),this.onClick())},buildLabelEl:function(){this.options.showText&&(this.textEl=this.insertSpanEl(this.widgetEl,{class:"gl-star-rating-text"},!0))},buildWidgetEl:function(){var t=this.getOptionValues(),e=this.insertSpanEl(this.el,{class:"gl-star-rating-stars"},!0);for(var i in t)if(t.hasOwnProperty(i)){var s=this.createSpanEl({"data-value":i,"data-text":t[i]});e.innerHTML+=s.outerHTML}this.widgetEl=e,this.buildLabelEl()},changeTo:function(t){(t<0||""===t)&&(t=0),t>this.stars&&(t=this.stars),this.widgetEl.classList.remove("s"+10*this.current),this.widgetEl.classList.add("s"+10*t),this.options.showText&&(this.textEl.textContent=t<1?this.options.initialText:this.widgetEl.childNodes[t-1].dataset.text),this.current=t},clear:function(){this.options.clearable&&(this.el.value=this.selected="",this.changeTo(0))},createSpanEl:function(t){var e=s.createElement("span");for(var i in t=t||{})t.hasOwnProperty(i)&&e.setAttribute(i,t[i]);return e},extend:function(){var t=[].slice.call(arguments),i=t[0],s=t.slice(1);return Object.keys(s).forEach(function(t){for(var e in s[t])s[t].hasOwnProperty(e)&&(i[e]=s[t][e])}),i},getIndexFromPosition:function(t){var e={},i=this.widgetEl.offsetWidth;return e.ltr=Math.max(t-this.offsetLeft,1),e.rtl=i-e.ltr,Math.min(Math.ceil(e[this.direction]/Math.round(i/this.stars)),this.stars)},getOptionValues:function(){for(var t=this.el,e={},i={},s=0;s<t.length;s++)""!==t[s].value&&(e[t[s].value]=t[s].text);return Object.keys(e).sort().forEach(function(t){i[t]=e[t]}),i},getSelectedValue:function(){return this.el.options[this.el.selectedIndex].value},handleEvents:function(){var t=this.el,e=t.closest("form"),i=this.widgetEl;this.events={mousemove:this.onMousemove.bind(this)},t.addEventListener("change",this.onChange.bind(this)),i.addEventListener("click",this.onClick.bind(this)),i.addEventListener("mouseenter",this.onMouseenter.bind(this)),i.addEventListener("mouseleave",this.onMouseleave.bind(this)),e&&e.addEventListener("reset",this.onReset.bind(this))},insertSpanEl:function(t,e,i){var s=this.createSpanEl(e);return t.parentNode.insertBefore(s,!0===i?t.nextSibling:t),s},isCloneable:function(t){return Array.isArray(t)||"[object Object]"=={}.toString.call(t)},onChange:function(){this.changeTo(this.getSelectedValue())},onClick:function(t){var e=this.current;t===i||(e=this.getIndexFromPosition(t.pageX),""===this.current||parseFloat(this.selected)!==e)?(this.el.value=e,this.selected=e,this.changeTo(e),t!==i&&"function"==typeof this.options.onClick&&this.options.onClick.call(this,this.el)):this.clear()},onMouseenter:function(){var t=this.widgetEl.getBoundingClientRect();this.offsetLeft=t.left+s.body.scrollLeft,this.widgetEl.addEventListener("mousemove",this.events.mousemove)},onMouseleave:function(){this.widgetEl.removeEventListener("mousemove",this.events.mousemove),this.changeTo(this.selected)},onMousemove:function(t){this.changeTo(this.getIndexFromPosition(t.pageX))},onReset:function(){this.clear()},setDirection:function(){var t=this.el.parentNode;this.direction=e.getComputedStyle(t,null).getPropertyValue("direction"),t.classList.add("gl-star-rating-"+this.direction)},setStarCount:function(){for(var t=this.el,e=this.stars=0;e<t.length;e++)if(""!==t[e].value){if(isNaN(parseFloat(t[e].value))||!isFinite(t[e].value))return void(this.stars=0);this.stars++}},wrapEl:function(){this.insertSpanEl(this.el,{class:"gl-star-rating","data-star-rating":""}).appendChild(this.el)}},"function"==typeof define&&define.amd?define([],function(){return t}):"object"==typeof module&&module.exports?module.exports=t:e.StarRating=t}(window,document);